(function(c){function pb(){E=c(window);ac=c("body");qb=c("body, html");q=c("<div />").addClass("jackbox-modal");m=c("<div />").addClass("jackbox-holder");da=c("<div />").addClass("jackbox-wrapper");U=c("<div />").addClass("jackbox-preloader");ea=c("<span />").addClass("jackbox-panel jackbox-panel-left");oa=c("<span />").addClass("jackbox-panel jackbox-panel-right");var a=l.createDocumentFragment();a.appendChild(da[0]);a.appendChild(U[0]);q[0].appendChild(a);a=l.createDocumentFragment();a.appendChild(ea[0]);
a.appendChild(oa[0]);a.appendChild(m[0]);da[0].appendChild(a);fa=c("<div />").addClass("jackbox-container");pa||(a=c("<span />").addClass("jackbox-pre-outside").appendTo(U),c("<span />").addClass("jackbox-pre-inside").appendTo(a));V*=2;Ua=0;a=l.createDocumentFragment();rb&&(x=c(rb).hide(),a.appendChild(x[0]));a.appendChild(fa[0]);sb&&(y=c(sb).hide(),a.appendChild(y[0]));m[0].appendChild(a);tb=-(B+Aa);qa=[];Ha=[];F=[];G=[];ub.each(ad);Q&&(c.address.internalChange(vb),c.address.externalChange(bd));
bc=!0;Ia&&(Q?setTimeout(Ia,250):Ia(),Ia=null);ub=Ha=rb=sb=qa=null}function ad(){var a=c(this).attr("data-group").split(" ").join("").toLowerCase();if(pa){for(var b=G.length,e=!1;b--;)if(G[b]===a){e=!0;break}e||cc(a)}else-1===G.indexOf(a)&&cc(a)}function cc(a){G[G.length]=a;Ha=[];c(".jackbox[data-group="+a+"]").each(dc);F[F.length]=Ha;Va++}function dc(a){isNaN(a)?f=a:(f=c(this).data({id:a,cat:Va}),Ha[a]=f);if(h=f.attr("href")||f.attr("data-href")){var b;a="#"!==h.charAt(0)?h.toLowerCase().split(".").pop():
"inline";if(b=-1!==h.search("youtube.com")?"youtube":-1!==h.search("vimeo.com")?"vimeo":"mp4"===a?"local":!1){if(f.data("type",b),!f.attr("data-thumbnail"))if("vimeo"===b){var e=f;c.getJSON("http://vimeo.com/api/v2/video/"+h.split("http://vimeo.com/")[1]+".json?callback=?",{format:"json"},function(a){e.attr("data-thumbnail",a[0].thumbnail_small)})}else"youtube"===b&&f.attr("data-thumbnail","http://img.youtube.com/vi/"+h.split("http://www.youtube.com/watch?v=")[1]+"/1.jpg")}else if("jpg"===a||"png"===
a||"jpeg"===a||"gif"===a)f.data("type","image");else switch(a){case "mp3":f.data("type","audio");break;case "swf":f.data("type","swf");break;case "inline":f.data("type","inline");break;default:f.data("type","iframe")}f.on("click.jackbox",cd);if(K=f.attr("data-description")){if(qa)if(a=qa.indexOf(K),-1===a){K=c(K);if(!K.length)return;qa[qa.length]=K}else K=qa[a];else if(K=c(K),!K.length)return;f.data("description",K)}}}function bd(a){if(fc){fc=!1;var b=l.URL.split("?url=");if(2===b.length){window.location=
b[0]+"#/"+b[1];return}}clearTimeout(Ja);gc(a.value);-1!==C?hc?(hc=!1,vb()):Ja=setTimeout(vb,750):W&&wb()}function vb(a){"object"===typeof a&&(clearTimeout(Ja),gc(a.value));-1!==C?ic():W&&wb()}function gc(a){H&&(!ga&&!Ba)&&r[d].removeClass("jb-thumb-active");"/"!==a?(a=a.split("/"),3===a.length?(d=parseInt(a[2],10)-1,isNaN(d)&&(d=0),ha=a[1]):isNaN(a[1])?(d=0,ha=a[1]):(d=parseInt(a[1],10)-1,ha="/")):(ha="/",d=0);if("/"!==ha)for(a=Va;a--;){if(G[a]===ha){C=a;L=F[C].length;R=1!==L;break}}else C=-1;Ba=
!1}function Wa(){clearTimeout(jc);jc=setTimeout(ia,100)}function cd(a){a.stopPropagation();a.preventDefault();a=c(this).data();Xa(a.cat,a.id,!0)}function Xa(a,b,e){clearTimeout(Ja);if(!e){if(H)for(e=r.length;e--;)r[e].off("click.jackbox");ea.off(".jackbox");oa.off(".jackbox");u&&xb&&j.cjSwipe("unbindSwipe")}Q?c.address.value(G[a]+"/"+(b+1)):(H&&(!ga&&!Ba)&&r[d].removeClass("jb-thumb-active"),d=b,C=a,L=F[C].length,R=1!==L,ic())}function yb(a){if(a&&(a.stopPropagation(),Ka))return!1;W&&(H&&!ga&&r[d].removeClass("jb-thumb-active"),
d<F[C].length-1?d++:d=0,Ba=!0,Xa(C,d))}function zb(a){if(a&&(a.stopPropagation(),Ka))return!1;W&&(H&&!ga&&r[d].removeClass("jb-thumb-active"),0<d?d--:d=F[C].length-1,Ba=!0,Xa(C,d))}function kc(){for(var a=[q[0],da[0],m[0],fa[0]],b=4;b--;)a[b].removeEventListener("touchstart",z,!1),a[b].removeEventListener("touchmove",z,!1),a[b].removeEventListener("touchend",z,!1)}function ic(){Ya=F[C];if(f=Ya[d]){if(u)for(var a=[q[0],da[0],m[0],fa[0]],b=4;b--;)a[b].addEventListener("touchstart",z,!1),a[b].addEventListener("touchmove",
z,!1),a[b].addEventListener("touchend",z,!1);h=f.attr("href")||f.attr("data-href");W?(Ka=!0,lc(),mc()):(W=!0,u||(qb.stop(),Ua=E.scrollTop()),q.appendTo(ac).one("click.jackbox",nc),oc=q.parents().each(dd),pc||(pc=!0,Za=parseInt(m.css("padding-left"),10)+parseInt(m.css("padding-right"),10),Ca=parseInt(m.css("padding-top"),10)+parseInt(m.css("padding-bottom"),10),Ab=parseInt(ea.css("width"),10)+14,$a=Ca+V,Bb=B+(Aa<<1),ab=parseInt(U.css("margin-top"),10),qc=ab-(Bb>>1),rc=parseInt(m.css("padding-left"),
10),sc=parseInt(m.css("padding-top"),10),M=c(".jackbox-fullscreen"),M.length||(M=null),ra=!u&&"safari"!==bb&&("webkitRequestFullScreen"in q[0]||"mozFullScreenEnabled"in l)),ja=!Cb&&cb&&R?0:tb,D=E.width(),I=E.height(),m.css({width:D,height:I,marginLeft:-(D>>1)-rc,marginTop:-(I>>1)-sc}),Jacked.fadeIn(q[0],{callback:ed}),tc=setTimeout(mc,250),da.on("click.jackbox",uc))}}function dd(){c(this).addClass("jackbox-overflow")}function fd(){c(this).removeClass("jackbox-overflow")}function ed(){E[0].scrollTo(0,
0)}function mc(){H&&(r[d].addClass("jb-thumb-active"),ga?ga=!1:Db(!1,!0));var a=f.attr("data-autoplay")?f.attr("data-autoplay"):vc,b=f.data("description")||null,e=f.attr("data-title")||"",ec;db="true"===f.attr("data-scaleUp");eb=b?b.html():!1;S=f.data("type");e?(Eb=e,ka=escape(Eb)):(ka=!1,"undefined"!==typeof A&&(A.data("links")&&A.data("links").off(".jackbox"),A.empty()));u&&(xb="image"===S);"image"!==S&&wc();"inline"!==S&&l.addEventListener("touchmove",z,!1);568<D?U.css("margin-top",0===ja?qc:ab):
U.css("margin-top",ab);da.show();U.addClass("jackbox-spin-preloader");switch(S){case "image":La=!0;j=c("<img />").addClass("jackbox-content").one("load.jackbox",Ma).prependTo(fa);u&&(j[0].addEventListener("touchstart",z,!1),j[0].addEventListener("touchmove",z,!1),j[0].addEventListener("touchend",z,!1));j.attr("src",h);break;case "youtube":sa(gd.split("{url}").join(h.split("watch?v=")[1]).split("{autoplay}").join("true"===a?1:0));break;case "vimeo":sa(hd.split("{url}").join(h.substring(h.lastIndexOf("/"))).split("{autoplay}").join(a));
break;case "local":b=Fb();e=f.attr("data-flashHasPriority")?f.attr("data-flashHasPriority"):xc.toString();ec="false"===e&&ra&&"firefox"!==bb;b=f.attr("data-poster")?b+f.attr("data-poster"):"false";sa(id+"?video="+h+"&autoplay="+a+"&flashing="+e+"&width="+N+"&height="+O+"&poster="+b,!0);break;case "audio":Fb();sa(jd+"?audio="+h+"&title="+(f.attr("data-audiotitle")?f.attr("data-audiotitle"):ka)+"&autoplay="+a);break;case "swf":Fb();sa(kd+"?swf="+h+"&width="+(k.toString()+"&height="+g.toString()));break;
case "inline":a=c(h);j=c("<div />").addClass("jackbox-content jackbox-html").html(a.length?a.html():"").prependTo(fa);j.css("width",k);f.attr("data-height",j.outerHeight(!0));wc();Ma();break;default:sa(h,!1,!0)}ra&&(!ec?M.show():M.hide())}function Fb(){if(-1===h.search("http")){var a=l.URL.split("#")[0];"/"!==a[a.length-1]&&(a=a.substring(0,a.lastIndexOf("/")+1));h=a+h;return a}}function ld(){la.css("visibility","hidden")}function md(){p.data("offLeft",p.offset().left)}function yc(){Da.css({opacity:0,
visibility:"hidden"})}function zc(a){"object"===typeof a&&a.stopPropagation();s<L-ma&&(s++,fb(!1,!0))}function Ac(a){"object"===typeof a&&a.stopPropagation();0<s&&(s--,fb(!1,!0))}function nd(a){a.stopPropagation();a=c(this).parent();a.addClass("jb-thumb-fadein");u||a.addClass("jb-thumb-hover");a.data("id")===d&&a.addClass("jb-thumb-active")}function Bc(a){a.stopPropagation();if(Ka)return!1;a=c(this).data("id");a!==d&&(H&&r[d].removeClass("jb-thumb-active"),d=a,ga=!0,Xa(C,d))}function od(){Na?Cc():
(E.off(".jackbox"),Na=!0,l.mozFullScreenEnabled?(l.addEventListener("mozfullscreenchange",gb,!1),q[0].mozRequestFullScreen()):q[0].webkitRequestFullScreen&&(l.addEventListener("webkitfullscreenchange",gb,!1),q[0].webkitRequestFullScreen()))}function gb(){l.webkitIsFullScreen||l.mozFullScreen?ia():Cc(!0)}function Gb(a){l.removeEventListener(a.type,Gb,!1);ia();E.on("resize.jackbox",Wa)}function Cc(a){Na=!1;l.mozFullScreenEnabled?(l.removeEventListener("mozfullscreenchange",gb,!1),a?(ia(),E.on("resize.jackbox",
Wa)):(l.addEventListener("mozfullscreenchange",Gb,!1),l.mozCancelFullScreen())):q[0].webkitRequestFullScreen&&(l.removeEventListener("webkitfullscreenchange",gb,!1),a?(ia(),E.on("resize.jackbox",Wa)):(l.addEventListener("webkitfullscreenchange",Gb,!1),l.webkitCancelFullScreen()))}function wc(){La=!1;N=f.attr("data-width")?parseInt(f.attr("data-width"),10):Dc;O=f.attr("data-height")?parseInt(f.attr("data-height"),10):Ec;db="true"===f.attr("data-scaleUp");Fc()}function Fc(){hb=N+Za+Ab+V;Hb=O+$a;ia("true")}
function lc(){clearTimeout(tc);Jacked.stopTween(m[0]);E.off(".jackbox");l.removeEventListener("touchmove",z,!1);j&&(Jacked.stopTween(j[0]),j.remove(),j=null);ib&&(ib.remove(),ib=null);x&&(Jacked.stopTween(x[0],!0),x.hide());y&&(Jacked.stopTween(y[0],!0),y.hide());t&&(t.removeClass("jb-info-inactive"),Jacked.stopTween(J[0]),J.empty().hide())}function nc(a){a.stopPropagation();Q?c.address.value(""):wb()}function wb(){clearTimeout(Ja);lc();q.unbind(".jackbox");if(R){ta&&ta.off(".jackbox");ua&&ua.off(".jackbox");
Oa&&p&&p.off(".jackbox");Jacked.stopTween(oa[0],!0);Jacked.stopTween(ea[0],!0);var a={opacity:0,visibility:"hidden"};oa.off(".jackbox").css(a);ea.off(".jackbox").css(a)}else va&&va.show(),v&&v.show();da.hide().off(".jackbox");U.removeClass("jackbox-spin-preloader");"undefined"!==typeof A&&(A.data("links")&&A.data("links").off(".jackbox"),A.empty());ra&&M.off(".jackbox");wa&&wa.unbind(".jackbox");t&&t.off(".jackbox");if(H){Jacked.stopTween(X[0]);for(X.off(".jackbox").hide();r.length;)a=r[0],Jacked.stopTween(a[0]),
a.remove(),r.shift();Y.off(".jackbox").hide();Z.off(".jackbox").hide();u&&p.cjSwipe("unbindSwipe");Jacked.stopTween(P[0]);P.empty().css("margin-left",0);v&&(v.off(".jackbox"),v&&(T.hide(),$.show()));H=r=null}oc.each(fd);Jacked.fadeOut(q[0],{duration:1E3,callback:pd});m.css({marginLeft:qd,marginTop:rd});u?(kc(),l.removeEventListener("touchmove",z,!1)):setTimeout(sd,10);la&&la.css("visibility","hidden");f=W=Na=ga=Ib=jb=Ba=Jb=Ea=null}function sd(){0!==Ua&&qb.animate({scrollTop:Ua},{duration:300,queue:!1})}
function pd(){q.detach()}function td(a){!a?yb():zb()}function z(a){a.preventDefault()}function ud(a,b){if(!W&&"success"===b.toLowerCase()&&a){var e=a.length,f=document.URL;for(f.substring(0,f.lastIndexOf("/"));e--;)c("<img />").attr("src",Gc+"/"+a[e].split("../").join(""))}}function vd(){var a=c(this),b=a.next("img"),e=b.attr("src");b.length&&(a=c("<img />").attr({width:b.attr("width"),height:b.attr("height")}).data("parent",a).one("load.jackbox",wd).insertAfter(b),b.remove(),a.attr("src",e))}function wd(){var a=
c(this),b=a.data("parent"),e=parseInt(b.css("width"),10)||b.width(),f=parseInt(b.css("height"),10)||b.height(),b=c("<canvas />").addClass("jackbox-canvas-blur").attr({width:e,height:f}).insertBefore(b),f=Date.now(),e=f+1,f=f+2;a.attr("id",e);b.attr("id",f);StackBlurImage(e,f,29)}function xd(){var a=c(this);a.parent().data({tip:a,tipWidth:a.width()-27,tipHeight:a.height()+17}).on("mouseenter.jackbox",yd).on("mouseleave.jackbox",zd)}function yd(){var a=c(this),b=a.offset(),e=a.data();e.tipX=b.left;
e.tipY=b.top;e.tip.css({opacity:1,visibility:"visible"});a.on("mousemove.jackbox",Hc)}function zd(){var a=c(this).off("mousemove.jackbox");pa?a.data("tip").css("opacity",0):a.data("tip").css({opacity:0,visibility:"hidden"})}function Ad(a){a.stopImmediatePropagation()}function uc(a){c(a.target).is("a")||(a.stopPropagation(),a.preventDefault())}var w={useThumbs:!0,deepLinking:!0,autoPlayVideo:!1,flashVideoFirst:!1,defaultVideoWidth:960,defaultVideoHeight:540,thumbnailWidth:75,thumbnailHeight:50,useThumbTooltips:!0,
preloadGraphics:!0,showInfoByDefault:!1,thumbsStartHidden:!1,fullscreenScalesContent:!0,defaultShareImage:"/v4/static/jackbox/img/default_share.jpg"},V=10,Aa=2,Gc="/v4/static/jackbox",Bd=Gc+"/php/graphics.php",kd="/v4/static/jackbox/modules/jackbox_swf.html",id="/v4/static/jackbox/modules/jackbox_video.html",jd="/v4/static/jackbox/modules/jackbox_audio.html",hd="http://player.vimeo.com/video{url}?title=0&byline=0&portrait=0&autoplay={autoplay}&color=FFFFFF&wmode=transparent",gd="http://www.youtube.com/embed/{url}?autoplay={autoplay}&autohide=1&hd=1&iv_load_policy=3&showinfo=0&showsearch=0&wmode=transparent",
rb='<div class="jackbox-top clearfix"><div class="jackbox-social"></div><div class="jackbox-top-icons"><span class="jackbox-fullscreen"><span class="jackbox-button jackbox-fs"></span><span class="jackbox-button jackbox-ns"></span></span><span class="jackbox-button jackbox-button-margin jackbox-close"></span></div><div />',sb='<div class="jackbox-bottom clearfix"><div class="jackbox-controls"><span class="jackbox-button jackbox-arrow-left"></span><span class="jackbox-button jackbox-arrow-right"></span></div><div class="jackbox-title-text"><span class="jb-current"></span><span class="jb-divider">/</span><span class="jb-total"></span><span class="jackbox-title-txt"></span></div><div class="jackbox-bottom-icons"><span class="jackbox-button jackbox-info"></span><span class="jackbox-button-margin jackbox-button-thumbs"><span class="jackbox-button jackbox-hide-thumbs"></span><span class="jackbox-button jackbox-show-thumbs"></span></span></div></div>',
jc,y,ra,rc,sc,Kb,Bb,kb,tb,Na,Lb,Ic,Ca,Za,Jc,la,Ab,Mb,P,p,Nb,Z,x,J,aa,T,$,oa,M,Ua,ea,ka,Y,fa,U,ma,qa,Ob,Eb,xb,Ea,Da,ja,v,wa,eb,va,Kc,Oa,Lc,xa,Fa,s,da,ya,ua,R,ab,ta,db,Mc,u,$a,lb,Pa,q,A,f,Ha,t,l,h,k,E,L,Nc,G,g,ha,F,pa,za,Pb,tc,Ia,r,ac,m,ub,N,mb,Ja,Oc,j,O,La,D,I,hb,Hb,S,oc,bb,ba,K,W,pc,qb,cb,Ka,ga,H,rd,Ib,Ya,Q,Qa,ib,X,jb,qc,qd,Pc,Ba,Qb,Jb,vc,ca,bc,B,xc,Qc,Rc,Cb,Dc,Ec,d=1,C=-1,Va=0,hc=!0,fc=!0,Sc={init:function(a,b){!Pc&&"undefined"!==typeof Jacked&&(b&&c.extend(w,b),cb=w.useThumbs,Q=w.deepLinking,Oa=
w.useThumbTooltips,vc=w.autoPlayVideo,ca=w.thumbnailWidth,Oc=w.fullscreenScalesContent,B=w.thumbnailHeight,xc=w.flashVideoFirst,Rc=w.showInfoByDefault,Cb=w.thumbsStartHidden,Qc=w.defaultShareImage,Dc=w.defaultVideoWidth,Ec=w.defaultVideoHeight,l=document,Pc=!0,ba=ca+Aa,mb=-1!==l.URL.search("file:///"),Jacked.setEngines({ios:!0,safari:!0,opera:!0,firefox:!0}),w.preloadGraphics&&!mb&&c.getJSON(Bd+"?jackbox_path=../img/graphics/",ud),ub=a,w=null,pa=Jacked.getIE(),u=Jacked.getMobile(),bb=Jacked.getBrowser(),
Nc="ie"===bb,"undefined"!==typeof c.address&&Q?Nc?(pb(),c.address.update()):c.address.init(pb):(Q=!1,pb()),"undefined"!==typeof StackBlurImage&&(!mb&&!pa)&&c(".jackbox-hover-blur").each(vd),c(".jackbox-tooltip").each(xd))},frameReady:function(){W&&Ma()},newItem:function(a,b){var e=G.length,c=-1,f,d;if(b&&"object"===typeof b){var g,j,k;for(g in b)"trigger"!==g&&(j="data-"+g,k=b[g],a.attr(j,k),"group"===g&&(d=k))}else b=null;d||(d=a.attr("data-group"));if(d){for(d=d.split(" ").join("").toLowerCase();e--;)if(G[e]===
d){c=e;break}if(-1<c){d=F[c];-1!==d.indexOf(a)&&(a.trigger("click"),f=!0);if(f)return;e=d.length;d[e]=a}else c=G.length,e=F.length,G[c]=d,Va++,F[e]=[a],e=0;dc(a);a.data({id:e,cat:c});b&&b.trigger&&a.trigger("click")}}},sa,nb={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen"};sa=function(a,b,e){nb.width=k;nb.height=g;nb.scrolling=!e?"no":"auto";j=c("<iframe />").attr(nb).addClass("jackbox-content").prependTo(fa);
if(!b)j.one("load.jackbox",Ma);j.attr("src",a)};var Ma,Rb={};Ma=function(a){a&&a.stopPropagation();La&&(N=this.width||j.width(),O=this.height||j.height(),Fc());Rb.width=k;Rb.height=g;j.css(Rb);Sb(!0);Lb&&Lb();E.on("resize.jackbox",Wa)};var Sb,na={},Ga={},Ra={};Sb=function(a){if(a){260>k&&(za+=260-k);a=Math.max(k,260);if(a===Ea&&g===Ob){Tb();return}na.callback=Tb;na.duration=Ea?50<Math.abs(a-Ea)||50<Math.abs(g-Ob)?600:300:600}else a=k,Ra.width=a,na.duration=300,delete na.callback,x&&Jacked.tween(x[0],
Ra,na),y&&Jacked.tween(y[0],Ra,na),Ra.height=g,Jacked.stopTween(j[0],!0),Jacked.tween(j[0],Ra,na);Ga.marginLeft=-((za>>1)+0.5|0);Ga.marginTop=-((Pb>>1)+0.5|0);Ga.height=g;Ga.width=a;Ea||(Ga.opacity=1);Jacked.tween(m[0],Ga,na);Ea=a;Ob=g};var Tb,Sa={},Tc={opacity:1,visibility:"visible"};Tb=function(){Uc();U.removeClass("jackbox-spin-preloader");var a=Math.max(k,260);Sa.duration=600;La&&!pa?Jacked.fadeIn(j[0],Sa):(j.show(),("audio"===S||"local"===S)&&j[0].contentWindow.cjInit());Sa.duration=300;pa?(x&&
x.css("width",a).show(),y&&y.css("width",a).show()):(x&&(x.css("width",a),Jacked.fadeIn(x[0],Sa)),y&&(y.css("width",a),Jacked.fadeIn(y[0],Sa)));t&&eb?(t.show(),J.html(eb).show(),aa=-J.outerHeight(),la.css("height",-aa<g?-aa:g),Rc?(Fa=!0,t.addClass("jb-info-inactive"),J.css("margin-top",0)):(Fa=!1,J.css("margin-top",aa))):t&&(t.hide(),J.hide());Ka=!1;!jb&&R&&(ea.css(Tc),oa.css(Tc));if(!Jb&&cb&&R){var a=F[C],b=[],e=L,f,d,h,n,m;for(Jb=!0;e--;)h=a[e],h.attr("data-thumbnail")?b[e]=!1:(f=h.children("img"),
f.length?(h.attr("data-thumbnail",f.attr("src")),b[e]=f):("image"===h.data("type")?h.attr("data-thumbnail",h.attr("href")||h.attr("data-href")):h.attr("data-thumbnail","/v4/static/jackbox/img/thumbs/default.jpg"),b[e]=!1));r=[];X||(e=l.createDocumentFragment(),h=B>>1,X=c("<div />").addClass("jackbox-thumb-holder").css("height",B).appendTo(q),p=c("<div />").addClass("jackbox-thumb-panel").css("height",B),Z=c("<div />").addClass("jackbox-thumb-right"),Y=c("<div />").addClass("jackbox-thumb-left"),e.appendChild(p[0]),
e.appendChild(Z[0]),e.appendChild(Y[0]),p[0].cjThumbs=!0,X[0].appendChild(e),P=c("<div />").addClass("jackbox-thumb-strip").appendTo(p),Y.css("top",h),Z.css("top",h));h=l.createDocumentFragment();for(e=0;e<L;e++){d=r[e]=c("<div />").data("id",e).addClass("jackbox-thumb").css({width:ca,height:B,left:ba*e}).on("click.jackbox",Bc);if(Oa&&(f=Ya[e].attr("data-thumbTooltip")||Ya[e].attr("data-title")))d.data("theTitle",f).on("mouseenter.jackbox",Vc).on("mouseleave.jackbox",yc);h.appendChild(d[0]);f=c("<img />").addClass("jb-thumb").one("load.jackbox",
nd).appendTo(d);d.data("theThumb",f);b[e]?(d=b[e].attr("width")||b[e].width(),n=b[e].attr("height")||b[e].height()):(d=ca,n=B);d>ca&&n>B&&(m=d>n?ca/d:B/n,d*=m,n*=m,n<B&&(m=(B-n)/B,d+=d*m,n+=n*m),d<ca&&(m=(ca-d)/ca,d+=d*m,n+=n*m),d!==(d|0)&&(d=d+1|0),n!==(n|0)&&(n=n+1|0));f.attr({width:d,height:n,src:a[e].attr("data-thumbnail")})}P[0].appendChild(h);Jc=r.length;Nb=ba*e;H=!0;s=0;X.on("click.jackbox",uc).show();Ub();v&&(Cb?($.hide(),T.show(),X.css("bottom",ja)):(T.hide(),$.show(),X.css("bottom",0)),
v.on("click.jackbox",Wc))}if(!jb){jb=!0;if(ra)M.on("click.jackbox",od);if(wa)wa.one("click.jackbox",nc);if(t)t.on("click.jackbox",Xc);if(R){if(ua)ua.on("click.jackbox",yb);if(ta)ta.on("click.jackbox",zb);if(Oa&&p)p.on("mouseenter.jackbox",md)}}u&&(j[0].removeEventListener("touchstart",z,!1),j[0].removeEventListener("touchmove",z,!1),j[0].removeEventListener("touchend",z,!1),kc());if(R){if(H)for(a=r.length;a--;)r[a].on("click.jackbox",Bc);ea.on("click.jackbox",zb);oa.on("click.jackbox",yb);u&&xb&&
j.cjSwipe("touchSwipe",td)}};var Uc,ob={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen",scrolling:"no"};Uc=function(){if(!Kc){Kc=!0;Pa=c(".jb-total");t=c(".jackbox-info");xa=c(".jb-divider");ya=c(".jb-current");wa=c(".jackbox-close");lb=c(".jackbox-title-text");A=c(".jackbox-title-txt");va=c(".jackbox-controls");ta=c(".jackbox-arrow-left");Qa=c(".jackbox-social");ua=c(".jackbox-arrow-right");v=c(".jackbox-button-thumbs");
T=c(".jackbox-show-thumbs");$=c(".jackbox-hide-thumbs");A.length||(A=null);lb.length||(lb=null);ta.length||(ta=null);xa.length||(xa=null);ua.length||(ua=null);va.length||(va=null);wa.length||(wa=null);Qa.length||(Qa=null);if(!ya.length||!Pa.length)ya=null;ra?(c(".jackbox-ns").hide(),M.length||(M=ra=null)):M&&M.hide();cb?v.length&&T.length&&$.length?T.hide():v=T=$=null:(v.hide(),v=T=$=null);t.length?(la=c("<div />").addClass("jackbox-info-text").appendTo(fa).css("visibility","hidden"),J=c("<div />").addClass("jackbox-description-text").appendTo(la)):
t=null;Oa&&(Da=c("<span />").addClass("jackbox-thumb-tip").css("bottom",B),Kb=c("<span />").addClass("jackbox-thumb-tip-text").text("render me").appendTo(Da),Da.appendTo(q),Ic=(parseInt(Da.css("padding-left"),10)<<1)-(Aa<<1))}R||(va&&va.hide(),v&&v.hide());if(lb){"false"===ka&&(ka=!1);var a=A&&ka,b=a?" -&nbsp;":"";ya&&R?(ya.text(d+1).show(),Pa.html(L+b).show(),xa&&xa.show()):(Pa&&Pa.hide(),ya&&ya.hide(),xa&&xa.hide());a&&(A.html(Eb),a=A.children("a"),a.length&&(a.on("click.jackbox",Ad),A.data("links",
a)))}if(Qa&&!mb){var e,a=l.URL.split("#")[0],b=a.length-1;-1!==a.search("/")&&("/"!==a.charAt(b)?(Q?e=a+"#/"+ha+"/"+(d+1):e=a,a=a.substring(0,a.lastIndexOf("/"))):(a=a.substring(0,b),Q?e=a+"/#/"+ha+"/"+(d+1):e=a));La?b=f.attr("href")||f.attr("data-href"):(b=f.children("img"),b=b.length?b.attr("src"):Qc);-1===b.search("http")&&(b="/"!==b.charAt(0)?a+"/"+b:a+b);ob.width=200;ob.height=21;ob.src="/v4/static/jackbox/modules/jackbox_social.php?url="+encodeURIComponent(e)+"&poster="+b+"&title="+(ka?escape(ka.replace(/(<([^>]+)>)/ig,
"")):escape(l.title));ib=c("<iframe />").attr(ob).appendTo(Qa)}};var Xc,Vb={},Wb={duration:300};Xc=function(a){a&&a.stopPropagation();Fa?(Vb.marginTop=aa,Wb.callback=ld,t.removeClass("jb-info-inactive")):(t.addClass("jb-info-inactive"),la.css("visibility","visible"),Vb.marginTop=0,delete Wb.callback);Jacked.tween(J[0],Vb,Wb);Fa=!Fa};var Vc,Xb={opacity:1,visibility:"visible"};Vc=function(){u&&(clearTimeout(Mc),Mc=setTimeout(yc,2E3));var a=c(this),b,e,d;Kb.text(a.data("theTitle"));b=parseInt(Kb.css("width"),
10);d=p.data("offLeft");a=a.offset().left;e=d+p.width()-b-Ic;Xb.width=b;Xb.left=a<d?d:a>e?e:a;Da.css(Xb)};var Wc,Yc={},Cd={duration:300};Wc=function(a){a.stopPropagation();0===ja?(ja=tb,v&&($.hide(),T.show())):(ja=0,v&&(T.hide(),$.show()));Yc.bottom=ja;Jacked.tween(X[0],Yc,Cd);569>D||(ia("true"),Sb())};var Ub,Yb={};Ub=function(a){var b=D-160;Nb<b?(ma=Jc,Qb=!1):(ma=b/ba|0,Qb=!0);kb=ba*ma-Aa;Mb=ma-1;Yb.marginLeft=-(kb>>1)-Aa;Yb.width=kb;p.css(Yb);P.css("width",Nb);Db(a)};var Db,Zc={},Dd={duration:300};
Db=function(a,b){if(a)s=d,0!==d&&d+ma>L&&(s=L-ma),Jacked.stopTween(P[0]),P.css("left",s*-ba);else{if(0===d)s=0;else if(d>s+Mb)for(;d>s+Mb;)s++;b?(Zc.left=s*-ba,Jacked.tween(P[0],Zc,Dd)):(Jacked.stopTween(P[0]),P.css("left",s*-ba))}fb(a,!1)};var fb,$c={},Ed={duration:300};fb=function(a,b){Y.off(".jackbox");Z.off(".jackbox");if(Qb)if(u&&p.cjSwipe("unbindSwipe"),s<L-ma?(Z.on("click.jackbox",zc).show(),u&&p.cjSwipe("touchSwipeLeft",zc,!0)):Z.hide(),0<s?(Y.on("click.jackbox",Ac).show(),u&&p.cjSwipe("touchSwipeRight",
Ac,!0)):Y.hide(),b)$c.left=s*-ba,Jacked.tween(P[0],$c,Ed);else{if(a||!Ib){var c=p.offset().left;Y.css("left",c);Z.css("left",c+kb);Ib=!0}}else Y.hide(),Z.hide()};var ia,Zb={opacity:1},Ta={};ia=function(a){D=E.width();I=Math.max(E.height(),226);var b=568<D&&0===ja?Bb:0;Lc="audio"!==S&&"inline"!==S?!Na?db:db||Oc:!1;if(hb<D&&Hb+b<I&&!Lc)k=N,g=O;else{k=D/hb;g=I/Hb;var c=k>g?g:k;k=N*c;g=O*c;D>I?g+$a+b>I&&(g=I-Ca-V-b,k=N*(g/O)):k>g?k+hb>D&&(k=D-V,g=O*(k/N)):g+$a+b>I&&(g=I-Ca-V-b,k=N*(g/O));k!==(k|0)&&(k=
k+1|0);g!==(g|0)&&(g=g+1|0)}if("inline"===S){var c=D-Za-Ab-V,d=I-Ca-V-b;k=N>c?c:N;g=O<d?O:g}za=k+Za;Pb=g+Ca+b;"true"!==a&&(Jacked.stopTween(m[0],!1,!0),j&&Jacked.stopTween(j[0],!0,!0),260>k&&(za+=260-k),a=Math.max(260,k),Zb.width=a,Zb.height=g,Ta.marginLeft=-(0.5*za+0.5|0),Ta.marginTop=-(0.5*Pb+0.5|0),Ta.width=a,Ta.height=g,m.css(Ta),j.css(Zb),y&&(Jacked.stopTween(y[0]),y.css("width",a)),x&&(Jacked.stopTween(x[0]),x.css("width",a)),t&&eb&&(aa=-J.outerHeight(),la.css("height",-aa<g?-aa:g),Fa||(Jacked.stopTween(J[0],
!1,!0),J.css("margin-top",aa))),H&&Ub(!0))};var Hc,$b={};Hc=function(a){var b=c(this).data();$b.left=a.pageX-b.tipX-b.tipWidth;$b.top=a.pageY-b.tipY-b.tipHeight;b.tip.css($b)};c.fn.jackBox=function(a,b){if(Sc.hasOwnProperty(a))Sc[a](this,b)};c.jackBox={available:function(a){a&&(bc?Q?setTimeout(a,250):a():Ia=a)},itemLoaded:function(a){Lb=a}}})(jQuery);function jackboxFrameReady(){jQuery.fn.jackBox("frameReady")};